<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Product Management · HAMT PASTRY</title>
<style>
  :root{
    --bg:#f5e6e0; --side:#e8d5c4; --side-b:#d7c0ad;
    --panel:#ffffff; --line:#ece2d9; --ink:#2a2a2a; --muted:#7a7066;
    --accent:#6a4b2f; --btn:#5c3d1f; --edit-bg:#d4b899; --edit-text:#6f5439;
    --danger:#c93a3a;
  }
  *{box-sizing:border-box;margin:0;padding:0}
  body{background:var(--bg);color:var(--ink);font:14px/1.5 -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif}
  .wrap{display:grid;grid-template-columns:206px 1fr;min-height:100vh}

  /* Sidebar */
  .side{background:var(--side);border-right:1px solid var(--side-b);padding:24px 0;position:sticky;top:0;height:100vh;overflow-y:auto}
  .brand{font-weight:800;margin:0 20px 32px;font-size:15px;letter-spacing:0.5px}
  .nav{display:flex;flex-direction:column}
  .nav a{display:flex;align-items:center;gap:12px;padding:14px 20px;color:#3d342b;text-decoration:none;font-size:14px;transition:background 0.15s}
  .nav a:hover,.nav a.active{background:#d4c4b3;font-weight:500}
  .ico{width:20px;height:20px;flex-shrink:0}

  /* Main */
  .main{padding:24px 32px;overflow-y:auto}
  .top{background:#f0e4db;border:1px solid #e5d5c6;border-radius:12px;padding:16px 24px;display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
  .title{font-weight:800;letter-spacing:1px;font-size:15px}
  .profile{display:flex;align-items:center;gap:12px}
  .profile-text{text-align:right;font-size:13px}
  .profile-text .name{font-weight:600}
  .profile-text .role{font-size:11px;color:#7a7066}
  .avatar{width:36px;height:36px;border-radius:50%;background:#c6ad96}
  .hr{height:1px;background:#d7c0ad;margin:0 0 20px}

  /* Button */
  .bar{display:flex;justify-content:flex-end;margin:0 0 20px}
  .btn{cursor:pointer;padding:11px 18px;border-radius:8px;border:none;background:var(--btn);color:#fff;font-weight:600;font-size:13px;transition:background 0.15s}
  .btn:hover{background:#4a3118}
  .btn:active{transform:scale(0.98)}
  .btn-danger{background:var(--danger)}
  .btn-danger:hover{background:#b02020}

  /* Card */
  .card{background:var(--panel);border:1px solid var(--line);border-radius:16px;overflow:hidden;box-shadow:0 1px 3px rgba(0,0,0,.03)}
  .head,.row{display:grid;grid-template-columns:80px 1fr 120px 100px 180px;gap:20px;align-items:center;padding:16px 24px}
  .head{color:#8b7f73;font-weight:600;font-size:13px;border-bottom:1px solid #f3ebe5;background:#fafafa}
  .list .row{border-bottom:1px solid #f9f4f0}
  .list .row:hover{background:#fdfbf9}
  .list .row:last-child{border-bottom:none}
  .thumb{width:60px;height:60px;border-radius:8px;border:1px solid #eee;object-fit:cover;background:#f5f5f5}
  .name{font-weight:500;font-size:14px}
  .center{text-align:center;font-size:14px}
  .right{display:flex;gap:8px;justify-content:flex-end}
  .chip{padding:7px 16px;border-radius:6px;background:var(--edit-bg);color:var(--edit-text);font-weight:600;border:none;cursor:pointer;font-size:13px;transition:all 0.15s}
  .chip:hover{background:#c9a87f}
  .chip-danger{background:#f0cfcf;color:#8a2626}
  .chip-danger:hover{background:#eab5b5}

  /* Modal */
  .modal{position:fixed;inset:0;background:rgba(0,0,0,.4);display:none;align-items:center;justify-content:center;z-index:999}
  .modal.show{display:flex}
  .sheet{width:520px;max-width:90vw;background:#fff;border-radius:14px;border:1px solid var(--line);padding:24px;box-shadow:0 8px 30px rgba(0,0,0,.2)}
  .sheet h3{margin-bottom:20px;font-size:18px;color:var(--ink)}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
  .field{display:flex;flex-direction:column;gap:6px}
  .field.full{grid-column:1/-1}
  label{font-size:12px;color:var(--muted);font-weight:600}
  input[type="text"],input[type="number"]{width:100%;padding:10px 12px;border:1px solid #e0d5c9;border-radius:8px;font-size:14px}
  input:focus{outline:none;border-color:var(--accent)}
  input[type="file"]{width:100%;font-size:13px;padding:8px}
  .preview{width:100%;max-height:200px;border-radius:8px;margin-top:8px;object-fit:cover;border:1px solid #e0d5c9;display:none}
  .preview.show{display:block}
  .actions{display:flex;gap:10px;justify-content:flex-end;margin-top:20px}
  .ghost{background:#fff;color:var(--btn);border:1px solid var(--btn);padding:10px 18px;border-radius:8px;cursor:pointer;font-weight:600;font-size:13px;transition:background 0.15s}
  .ghost:hover{background:#f9f7f5}

  .empty{text-align:center;padding:60px 20px;color:var(--muted)}
  .loading{text-align:center;padding:40px;color:var(--muted)}
</style>
</head>
<body>
<div class="wrap">
  <aside class="side">
    <div class="brand">HAMT PASTRY</div>
    <nav class="nav">
      <a class="active" href="/WEB/Admin.order.html">
        <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M3 7h18M5 7v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7"/>
          <path d="M8 7V5a2 2 0 1 1 4 0v2M12 7V5a2 2 0 1 1 4 0v2"/>
        </svg>
        Product
      </a>
      <a href="/WEB/Customer.html">
        <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M3 7h18M6 7v10h12V7M8 11h8M8 15h5"/>
        </svg>
        Order
      </a>
      <a href="/WEB/customervip.html">
        <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <circle cx="12" cy="8" r="3"/>
          <path d="M4 20a8 8 0 0 1 16 0"/>
        </svg>
        Customer
      </a>
      <a href="/WEB/customervip.html">
        <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M7 7h10l2 4-7 7-7-7 2-4z"/>
        </svg>
        Voucher
      </a>
      <a href="/WEB/vouchers.html">
        <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M3 3v18h18M7 13l4 4 7-9"/>
        </svg>
        Reports and Analytics
      </a>
    </nav>
  </aside>

  <main class="main">
    <div class="top">
      <div class="title">PRODUCT MANAGEMENT</div>
      <div class="profile">
        <div class="profile-text">
          <div class="name">Hamt Pastry</div>
          <div class="role">Admin</div>
        </div>
        <div class="avatar"></div>
      </div>
    </div>
    <div class="hr"></div>

    <div class="bar">
      <button class="btn" id="btnAdd">+ Add Product</button>
    </div>

    <section class="card">
      <div class="head">
        <div></div><div>Product</div><div class="center">Price</div><div class="center">Stock</div><div class="right">Action</div>
      </div>
      <div id="list" class="list"></div>
    </section>
  </main>
</div>

<div class="modal" id="modal">
  <div class="sheet">
    <h3 id="mTitle">Add Product</h3>
    <div class="grid">
      <div class="field full">
        <label>Product Name</label>
        <input id="mName" type="text" placeholder="Vd: Passion Mango Cheese">
      </div>
      <div class="field">
        <label>Price (VND)</label>
        <input id="mPrice" type="number" min="0" step="1000" value="625000">
      </div>
      <div class="field">
        <label>Stock</label>
        <input id="mStock" type="number" min="0" step="1" value="1">
      </div>
      <div class="field full">
        <label>Image</label>
        <input id="mFile" type="file" accept="image/*">
        <img id="mPreview" class="preview">
      </div>
    </div>
    <div class="actions">
      <button class="ghost" id="mCancel">Cancel</button>
      <button class="btn" id="mSave">Save</button>
    </div>
  </div>
</div>

<div class="modal" id="modalDelete">
  <div class="sheet" style="width:400px">
    <h3>Delete Product</h3>
    <p style="color:var(--muted);margin:0 0 20px">Delete "<strong id="delName"></strong>"?</p>
    <div class="actions">
      <button class="ghost" id="delCancel">Cancel</button>
      <button class="btn btn-danger" id="delConfirm">Delete</button>
    </div>
  </div>
</div>

<script>
const $={
  list:document.getElementById('list'),
  modal:document.getElementById('modal'),
  modalDel:document.getElementById('modalDelete'),
  mTitle:document.getElementById('mTitle'),
  mName:document.getElementById('mName'),
  mPrice:document.getElementById('mPrice'),
  mStock:document.getElementById('mStock'),
  mFile:document.getElementById('mFile'),
  mPreview:document.getElementById('mPreview'),
  delName:document.getElementById('delName')
};

let products=[];
let editId=null;
let delId=null;
let imgUrl=null;

const fmt=n=>Number(n||0).toLocaleString('vi-VN')+' ₫';

const defaults=[
  {id:1,name:'Strawberry cherry blossom',price:625000,stock:1,image:'https://images.unsplash.com/photo-1488477181946-6428a0291777?w=400&h=400&fit=crop'},
  {id:2,name:'Tiramisu De Caramel #2',price:625000,stock:2,image:'https://images.unsplash.com/photo-1571877227200-a0d98ea607e9?w=400&h=400&fit=crop'},
  {id:3,name:'Passion Fruit',price:625000,stock:1,image:'https://images.unsplash.com/photo-1565958011703-44f9829ba187?w=400&h=400&fit=crop'},
  {id:4,name:'Mango Coconut',price:625000,stock:3,image:'https://images.unsplash.com/photo-1587241321921-91a834d6d191?w=400&h=400&fit=crop'},
  {id:5,name:'Creamy Choco',price:625000,stock:3,image:'https://images.unsplash.com/photo-1578985545062-69928b1d9587?w=400&h=400&fit=crop'},
  {id:6,name:'Berry Fruit Vanilla',price:625000,stock:2,image:'https://images.unsplash.com/photo-1464349095431-e9a21285b5f3?w=400&h=400&fit=crop'}
];

function load(){
  const s=localStorage.getItem('hamt_products');
  products=s?JSON.parse(s):defaults;
  if(!s)save();
  render();
}

function save(){
  localStorage.setItem('hamt_products',JSON.stringify(products));
}

function render(){
  if(!products.length){
    $.list.innerHTML='<div class="empty">No products</div>';
    return;
  }
  $.list.innerHTML=products.map(p=>`
    <div class="row">
      <div><img class="thumb" src="${p.image||'https://via.placeholder.com/200/d4bfa0/6f5439?text=IMG'}"></div>
      <div class="name">${p.name}</div>
      <div class="center">${fmt(p.price)}</div>
      <div class="center">${p.stock||0}</div>
      <div class="right">
        <button class="chip" onclick="edit(${p.id})">Edit</button>
        <button class="chip chip-danger" onclick="del(${p.id})">Delete</button>
      </div>
    </div>
  `).join('');
}

document.getElementById('btnAdd').onclick=()=>{
  editId=null;
  imgUrl=null;
  $.mTitle.textContent='Add Product';
  $.mName.value='';
  $.mPrice.value='625000';
  $.mStock.value='1';
  $.mFile.value='';
  $.mPreview.classList.remove('show');
  $.modal.classList.add('show');
};

window.edit=id=>{
  const p=products.find(x=>x.id===id);
  if(!p)return;
  editId=id;
  imgUrl=p.image;
  $.mTitle.textContent='Edit Product';
  $.mName.value=p.name;
  $.mPrice.value=p.price;
  $.mStock.value=p.stock;
  $.mFile.value='';
  if(p.image){
    $.mPreview.src=p.image;
    $.mPreview.classList.add('show');
  }else{
    $.mPreview.classList.remove('show');
  }
  $.modal.classList.add('show');
};

document.getElementById('mCancel').onclick=()=>$.modal.classList.remove('show');
$.modal.onclick=e=>{if(e.target===$.modal)$.modal.classList.remove('show')};

$.mFile.onchange=e=>{
  const f=e.target.files[0];
  if(!f)return;
  if(f.size>5e6){
    alert('File quá lớn!');
    $.mFile.value='';
    return;
  }
  const r=new FileReader();
  r.onload=ev=>{
    imgUrl=ev.target.result;
    $.mPreview.src=imgUrl;
    $.mPreview.classList.add('show');
  };
  r.readAsDataURL(f);
};

document.getElementById('mSave').onclick=()=>{
  const name=$.mName.value.trim();
  const price=Number($.mPrice.value);
  const stock=Number($.mStock.value);
  if(!name){alert('Nhập tên!');return}
  if(price<0){alert('Giá không hợp lệ!');return}
  if(stock<0){alert('Stock không hợp lệ!');return}
  
  if(editId){
    const i=products.findIndex(x=>x.id===editId);
    if(i!==-1)products[i]={...products[i],name,price,stock,image:imgUrl||products[i].image};
  }else{
    products.unshift({id:Date.now(),name,price,stock,image:imgUrl});
  }
  save();
  render();
  $.modal.classList.remove('show');
  alert(editId?'Đã cập nhật!':'Đã thêm!');
};

window.del=id=>{
  const p=products.find(x=>x.id===id);
  if(!p)return;
  delId=id;
  $.delName.textContent=p.name;
  $.modalDel.classList.add('show');
};

document.getElementById('delCancel').onclick=()=>$.modalDel.classList.remove('show');
$.modalDel.onclick=e=>{if(e.target===$.modalDel)$.modalDel.classList.remove('show')};

document.getElementById('delConfirm').onclick=()=>{
  products=products.filter(x=>x.id!==delId);
  save();
  render();
  $.modalDel.classList.remove('show');
  alert('Đã xóa!');
};

load();
</script>
</body>
</html>
